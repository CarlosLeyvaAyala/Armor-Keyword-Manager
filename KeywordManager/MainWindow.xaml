<Window
  x:Class="KeywordManager.MainWindow"
  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
  xmlns:System="clr-namespace:System;assembly=System.Runtime"
  xmlns:c="clr-namespace:GUI.Commands;assembly=GUI"
  xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
  xmlns:local="clr-namespace:KeywordManager"
  xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
  xmlns:md="http://materialdesigninxaml.net/winfx/xaml/themes"
  xmlns:pp="clr-namespace:KeywordManager.Pages"
  Title="Skyrim Item Manager"
  Width="1100"
  Height="690"
  Background="{DynamicResource MaterialDesignPaper}"
  FontFamily="{DynamicResource MaterialDesignFont}"
  Loaded="Window_Loaded"
  TextElement.FontSize="13"
  TextElement.FontWeight="Regular"
  TextElement.Foreground="{DynamicResource MaterialDesignBody}"
  TextOptions.TextFormattingMode="Ideal"
  TextOptions.TextRenderingMode="Auto"
  WindowStartupLocation="CenterScreen"
  mc:Ignorable="d">
  <Window.CommandBindings>
    <CommandBinding Command="ApplicationCommands.Open" Executed="OnOpenFile" />
    <CommandBinding Command="ApplicationCommands.Save" Executed="OnSaveFile" />

    <CommandBinding
      CanExecute="OnCanExportAs"
      Command="c:AppCmds.ExportAs"
      Executed="OnExportAs" />

    <CommandBinding
      CanExecute="OnCanExport"
      Command="c:AppCmds.Export"
      Executed="OnExport" />
  </Window.CommandBindings>

  <Window.Resources>
    <local:IntToKeywordColor x:Key="IntToKeywordColor" />
  </Window.Resources>

  <DockPanel>
    <Menu Margin="0,0,0,5" DockPanel.Dock="Top">
      <MenuItem Header="_File">
        <MenuItem Command="ApplicationCommands.Open" Header="_Open" />
        <MenuItem Command="ApplicationCommands.Save" Header="_Save" />
        <MenuItem Header="_Save as..." />
        <Separator />
        <MenuItem
          Command="c:AppCmds.Export"
          Header="_Export"
          ToolTip="{Binding RelativeSource={RelativeSource Self}, Path=Command.Text}" />
        <MenuItem
          Command="c:AppCmds.ExportAs"
          Header="_Export as..."
          ToolTip="{Binding RelativeSource={RelativeSource Self}, Path=Command.Text}" />
      </MenuItem>
    </Menu>

    <StatusBar DockPanel.Dock="Bottom">
      <StatusBar.ItemsPanel>
        <ItemsPanelTemplate>
          <Grid>
            <Grid.ColumnDefinitions>
              <ColumnDefinition Width="auto" />
              <ColumnDefinition Width="Auto" />
              <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>
          </Grid>
        </ItemsPanelTemplate>
      </StatusBar.ItemsPanel>

      <StatusBarItem>
        <TextBlock x:Name="txtStatusTime" />
      </StatusBarItem>

      <Separator Grid.Column="1">
        <Separator.Style>
          <Style TargetType="Separator">
            <Setter Property="Margin" Value="5,0" />
            <Style.Triggers>
              <DataTrigger Binding="{Binding Text, ElementName=txtStatusTime}" Value="">
                <Setter Property="Visibility" Value="Collapsed" />
                <Setter Property="Margin" Value="0" />
              </DataTrigger>
            </Style.Triggers>
          </Style>
        </Separator.Style>
      </Separator>

      <StatusBarItem Grid.Column="2">
        <TextBlock
          x:Name="txtStatus"
          Margin="0"
          Text="" />
      </StatusBarItem>
    </StatusBar>

    <pp:PP_Items x:Name="ppItems" />
  </DockPanel>
</Window>
