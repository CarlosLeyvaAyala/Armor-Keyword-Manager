<Window
  x:Class="KeywordManager.MainWindow"
  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
  xmlns:System="clr-namespace:System;assembly=System.Runtime"
  xmlns:c="clr-namespace:GUI.Commands;assembly=GUI"
  xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
  xmlns:local="clr-namespace:KeywordManager"
  xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
  xmlns:md="http://materialdesigninxaml.net/winfx/xaml/themes"
  Title="Skyrim Item Manager"
  Width="1100"
  Height="690"
  Background="{DynamicResource MaterialDesignPaper}"
  FontFamily="{DynamicResource MaterialDesignFont}"
  Loaded="Window_Loaded"
  TextElement.FontSize="13"
  TextElement.FontWeight="Regular"
  TextElement.Foreground="{DynamicResource MaterialDesignBody}"
  TextOptions.TextFormattingMode="Ideal"
  TextOptions.TextRenderingMode="Auto"
  WindowStartupLocation="CenterScreen"
  mc:Ignorable="d">
  <Window.CommandBindings>
    <CommandBinding Command="ApplicationCommands.Open" Executed="OnOpenFile" />
    <CommandBinding Command="ApplicationCommands.Save" Executed="OnSaveFile" />

    <CommandBinding
      CanExecute="CmdDeleteCanExecute"
      Command="EditingCommands.Delete"
      Executed="CmdDeleteExecuted" />

    <CommandBinding
      CanExecute="OnCanExportAs"
      Command="c:AppCmds.ExportAs"
      Executed="OnExportAs" />

    <CommandBinding
      CanExecute="OnCanExport"
      Command="c:AppCmds.Export"
      Executed="OnExport" />
  </Window.CommandBindings>

  <Window.Resources>
    <local:IntToKeywordColor x:Key="IntToKeywordColor" />
    <Thickness x:Key="MarginStd">10</Thickness>
  </Window.Resources>

  <DockPanel>
    <Menu Margin="0,0,0,5" DockPanel.Dock="Top">
      <MenuItem Header="_File">
        <MenuItem Command="ApplicationCommands.Open" Header="_Open" />
        <MenuItem Command="ApplicationCommands.Save" Header="_Save" />
        <MenuItem Header="_Save as..." />
        <Separator />
        <MenuItem
          Command="c:AppCmds.Export"
          Header="_Export"
          ToolTip="{Binding RelativeSource={RelativeSource Self}, Path=Command.Text}" />
        <MenuItem
          Command="c:AppCmds.ExportAs"
          Header="_Export as..."
          ToolTip="{Binding RelativeSource={RelativeSource Self}, Path=Command.Text}" />
      </MenuItem>
      <MenuItem Header="_Items">
        <MenuItem Click="OnImportFromClipboard" Header="Get from _clipboard" />
      </MenuItem>
    </Menu>

    <StatusBar DockPanel.Dock="Bottom">
      <StatusBar.ItemsPanel>
        <ItemsPanelTemplate>
          <Grid>
            <Grid.ColumnDefinitions>
              <ColumnDefinition Width="auto" />
              <ColumnDefinition Width="Auto" />
              <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>
          </Grid>
        </ItemsPanelTemplate>
      </StatusBar.ItemsPanel>

      <StatusBarItem>
        <TextBlock x:Name="txtStatusTime" />
      </StatusBarItem>

      <Separator Grid.Column="1">
        <Separator.Style>
          <Style TargetType="Separator">
            <Setter Property="Margin" Value="5,0" />
            <Style.Triggers>
              <DataTrigger Binding="{Binding Text, ElementName=txtStatusTime}" Value="">
                <Setter Property="Visibility" Value="Collapsed" />
                <Setter Property="Margin" Value="0" />
              </DataTrigger>
            </Style.Triggers>
          </Style>
        </Separator.Style>
      </Separator>

      <StatusBarItem Grid.Column="2">
        <TextBlock
          x:Name="txtStatus"
          Margin="0"
          Text="" />
      </StatusBarItem>
    </StatusBar>

    <Grid Margin="20">
      <Grid.ColumnDefinitions>
        <ColumnDefinition Width="9*" />
        <ColumnDefinition Width="{DynamicResource GridSepHorizontal}" />
        <ColumnDefinition Width="8*" />
        <ColumnDefinition Width="{DynamicResource GridSepHorizontal}" />
        <ColumnDefinition Width="8*" />
      </Grid.ColumnDefinitions>

      <!--  ITEM DATA  -->
      <GroupBox
        Grid.Column="2"
        md:ColorZoneAssist.Mode="SecondaryMid"
        Header="Item data"
        Style="{StaticResource MaterialDesignCardGroupBox}">
        <DockPanel>
          <StackPanel DockPanel.Dock="Top">

            <ComboBox Margin="{DynamicResource MgGrpContent}" SelectedIndex="0">
              <ComboBoxItem Content="Armor" />
              <ComboBoxItem Content="﻿Weapon" />
              <ComboBoxItem Content="Ammo" />
            </ComboBox>

            <TextBox
              x:Name="tbItemName"
              Grid.Row="0"
              Grid.Column="1"
              Margin="{DynamicResource MarginStd}"
              HorizontalAlignment="Stretch"
              VerticalAlignment="Top"
              Text="Editor ID"
              TextWrapping="Wrap"
              Visibility="Collapsed" />

          </StackPanel>

          <GroupBox
            Margin="{DynamicResource MgTopNormal}"
            md:ColorZoneAssist.Mode="PrimaryLight"
            BorderThickness="0"
            DockPanel.Dock="Bottom"
            Header="Tags">
            <StackPanel>

              <ScrollViewer
                MaxHeight="100"
                HorizontalScrollBarVisibility="Hidden"
                VerticalScrollBarVisibility="Auto">
                <ItemsControl x:Name="lstItemTags" Width="{Binding ActualWidth, Mode=OneWay, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type ScrollViewer}}}">
                  <ItemsControl.ItemsPanel>
                    <ItemsPanelTemplate>
                      <WrapPanel />
                    </ItemsPanelTemplate>
                  </ItemsControl.ItemsPanel>
                  <ItemsControl.ItemTemplate>
                    <DataTemplate>
                      <md:Chip Content="{Binding}" IsDeletable="True" />
                    </DataTemplate>
                  </ItemsControl.ItemTemplate>
                </ItemsControl>
              </ScrollViewer>

              <ComboBox x:Name="cbItemTags" IsEditable="True" />
            </StackPanel>
          </GroupBox>

          <GroupBox
            Margin="{DynamicResource MgTopNormal}"
            md:ColorZoneAssist.Mode="PrimaryLight"
            BorderThickness="0"
            DockPanel.Dock="Bottom"
            Header="Keywords">
            <ListBox
              x:Name="lstItemKeywords"
              Margin="{DynamicResource MarginStd}"
              d:ItemsSource="{d:SampleData ItemCount=5}"
              SelectionMode="Extended">
              <ListBox.ContextMenu>
                <ContextMenu>
                  <MenuItem Command="EditingCommands.Delete" />
                </ContextMenu>
              </ListBox.ContextMenu>
              <ListBox.ItemTemplate>
                <DataTemplate>
                  <TextBlock
                    Cursor="Help"
                    Foreground="{Binding Color, Converter={StaticResource IntToKeywordColor}}"
                    Text="{Binding Name}"
                    ToolTipService.InitialShowDelay="100">
                    <TextBlock.ToolTip>
                      <StackPanel Orientation="Horizontal">
                        <Image
                          Grid.Column="0"
                          Width="50"
                          Height="50"
                          Margin="0,0,10,0"
                          HorizontalAlignment="Left"
                          Cursor="Help"
                          Source="{Binding Image}"
                          Stretch="UniformToFill" />
                        <TextBlock VerticalAlignment="Center" Text="{Binding Description}" />
                      </StackPanel>
                    </TextBlock.ToolTip>
                  </TextBlock>
                </DataTemplate>
              </ListBox.ItemTemplate>
            </ListBox>
          </GroupBox>

        </DockPanel>
      </GroupBox>

      <!--  NAVIGATOR  -->
      <GroupBox
        md:ColorZoneAssist.Mode="PrimaryMid"
        Header="Navigate"
        Style="{StaticResource MaterialDesignCardGroupBox}">
        <DockPanel>
          <TextBox
            Margin="{DynamicResource MgGrpContent}"
            md:HintAssist.Hint="Search..."
            DockPanel.Dock="Top" />

          <ListBox
            x:Name="lstNavItems"
            Margin="{DynamicResource MarginStd}"
            HorizontalContentAlignment="Stretch"
            d:ItemsSource="{d:SampleData ItemCount=5}"
            SelectionChanged="LstNavItems_SelectionChanged"
            SelectionMode="Extended">
            <ListBox.ItemTemplate>
              <DataTemplate>
                <Grid Margin="0,5">
                  <Grid.RowDefinitions>
                    <RowDefinition Height="auto" />
                    <RowDefinition Height="auto" />
                  </Grid.RowDefinitions>
                  <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="auto" />
                    <ColumnDefinition Width="*" />
                  </Grid.ColumnDefinitions>
                  <TextBlock
                    Grid.ColumnSpan="2"
                    FontSize="13"
                    Text="{Binding Name}" />
                  <TextBlock
                    Grid.Row="1"
                    Grid.Column="1"
                    HorizontalAlignment="Right"
                    VerticalAlignment="Bottom"
                    FontSize="11"
                    Opacity="0.5"
                    Text="{Binding EDID}" />
                  <TextBlock
                    Grid.Row="1"
                    Grid.Column="0"
                    VerticalAlignment="Bottom"
                    FontSize="10"
                    Opacity="0.5"
                    Text="{Binding Esp}" />

                </Grid>
              </DataTemplate>
            </ListBox.ItemTemplate>
          </ListBox>
        </DockPanel>
      </GroupBox>

      <!--  KEYWORDS  -->
      <GroupBox
        Grid.Column="4"
        md:ColorZoneAssist.Mode="PrimaryMid"
        Header="Keywords"
        Style="{StaticResource MaterialDesignCardGroupBox}">
        <DockPanel>
          <ListBox
            x:Name="lstKeywords"
            Margin="{DynamicResource MarginStd}"
            d:ItemsSource="{d:SampleData ItemCount=5}"
            KeyDown="LstKeywords_KeyDown"
            MouseDoubleClick="LstKeywords_MouseDoubleClick"
            SelectionMode="Extended">
            <ListBox.ItemTemplate>
              <DataTemplate>
                <Grid>
                  <Grid.Resources>
                    <System:Double x:Key="ImgSize">80</System:Double>
                  </Grid.Resources>
                  <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="90" />
                    <ColumnDefinition Width="*" />
                  </Grid.ColumnDefinitions>

                  <Image
                    Grid.Column="0"
                    Width="{DynamicResource ImgSize}"
                    Height="{DynamicResource ImgSize}"
                    HorizontalAlignment="Left"
                    Cursor="Help"
                    Source="{Binding Image}"
                    Stretch="UniformToFill"
                    ToolTipService.InitialShowDelay="50">
                    <Image.ToolTip>
                      <StackPanel>
                        <TextBlock
                          Margin="0,0,0,5"
                          FontSize="13"
                          FontWeight="DemiBold"
                          Text="{Binding Name}" />
                        <TextBlock Text="{Binding Description}" />
                      </StackPanel>
                    </Image.ToolTip>
                  </Image>

                  <TextBlock
                    Grid.Column="1"
                    VerticalAlignment="Center"
                    FontSize="11"
                    FontWeight="SemiBold"
                    Foreground="{Binding Color, Converter={StaticResource IntToKeywordColor}}"
                    Text="{Binding Name}" />
                </Grid>
              </DataTemplate>
            </ListBox.ItemTemplate>
            <ListBox.ContextMenu>
              <ContextMenu>
                <ContextMenu.Resources>
                  <Style x:Key="MenuItemColor" TargetType="MenuItem">
                    <Setter Property="HorizontalAlignment" Value="Center" />
                    <Setter Property="VerticalAlignment" Value="Center" />
                    <Setter Property="FontSize" Value="25" />
                    <!--<Setter Property="Header" Value="●" />-->
                  </Style>
                </ContextMenu.Resources>
                <MenuItem Header="_New keyword" />
                <MenuItem Header="_Delete" />
                <Separator />
                <MenuItem Click="OnChangeKeywordPic" Header="Change _picture" />
                <Separator />
                <MenuItem Header="Keyword color">
                  <MenuItem Background="{DynamicResource ColorKeywordDefault}" Style="{StaticResource MenuItemColor}" />
                  <MenuItem Background="{DynamicResource ColorKeywordRed}" Style="{StaticResource MenuItemColor}" />
                  <MenuItem Background="{DynamicResource ColorKeywordOrange}" Style="{StaticResource MenuItemColor}" />
                  <MenuItem Background="{DynamicResource ColorKeywordPurple}" Style="{StaticResource MenuItemColor}" />
                  <MenuItem Background="{DynamicResource ColorKeywordBlue}" Style="{StaticResource MenuItemColor}" />
                  <MenuItem Background="{DynamicResource ColorKeywordGreen}" Style="{StaticResource MenuItemColor}" />
                  <MenuItem Background="{DynamicResource ColorKeywordGray}" Style="{StaticResource MenuItemColor}" />
                </MenuItem>
              </ContextMenu>
            </ListBox.ContextMenu>
          </ListBox>
        </DockPanel>
      </GroupBox>
    </Grid>
  </DockPanel>
</Window>
